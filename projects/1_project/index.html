<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 3D Compressible Navier-Stokes Solver for Jet Flows | Carlos A. Gonzalez </title> <meta name="author" content="Carlos A. Gonzalez"> <meta name="description" content="Project for ME344 (High Performance Computing)"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%8A&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://cagonzal.github.io/projects/1_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Carlos</span> A. Gonzalez </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">3D Compressible Navier-Stokes Solver for Jet Flows</h1> <p class="post-description">Project for ME344 (High Performance Computing)</p> </header> <article> <p>This project was done in a collaboration with my classmate, Michael Whitmore. A 3D, compressible, finite difference code was written to solve the Navier-Stokes equations in Python. The motivation behind the project was to develop a solver that can simulate jet flows with an immersed passive tracer, a case that is representative of coughs and sneezes contaminated with COVID-19 viral droplets. The code was parallelized using mpi4py.</p> <p>The compressible Navier-Stokes equations are solved using a second order MacCormack scheme. The scheme uses a two-step time integration that uses first-order forward differences at the first step and first-order backward differences at the second step.</p> <ol> <li>Predictor Step: \(\overline{U}_{i,j,k}^{t+\Delta t} = U_{i,j,k}^t - \frac{\Delta t}{\Delta x} \left( E_{i+1,j,k}^t - E_{i,j,k}^t \right) - \frac{\Delta t}{\Delta y} \left( F_{i,j+1,k}^t - F_{i,j,k}^t \right) - \frac{\Delta t}{\Delta z} \left( G_{i,j,k+1}^t - G_{i,j,k}^t \right)\)</li> <li>Corrector Step: \(U_{i,j,k}^{t+\Delta t} = \frac{1}{2}\left(U_{i,j,k}^t + \overline{U}_{i,j,k}^{t+\Delta t} - \frac{\Delta t}{\Delta x} \left(\overline{E}_{i,j,k}^{t+\Delta t} - \overline{E}_{i-1,j,k}^{t+\Delta t}\right) - \frac{\Delta t}{\Delta y} \left(\overline{F}_{i,j,k}^{t+\Delta t} - \overline{F}_{i,j-1,k}^{t+\Delta t}\right) - \frac{\Delta t}{\Delta z} \left(\overline{G}_{i,j,k}^{t+\Delta t} - \overline{G}_{i,j,k-1}^{t+\Delta t}\right)\right)\)</li> </ol> <p>where</p> <p>\begin{equation} U = \begin{bmatrix} \rho, \, \rho u, \, \rho v, \, \rho w, \, E_t, \, \rho \phi \end{bmatrix} \end{equation}</p> <p>\begin{equation} E = \begin{bmatrix} \rho u^2 + p - \tau_{xx}, \, \rho uv - \tau_{xy}, \, \rho uw - \tau_{xz}, \, (E_t + p)u - u\tau_{xx} - v\tau_{xy} - w\tau_{xz} + q_x, \, \rho \phi - D\frac{\partial \phi}{\partial x} \end{bmatrix} \end{equation}</p> <p>\begin{equation} F = \begin{bmatrix} \rho v, \, \rho uv - \tau_{xy}, \, \rho v^2 + p - \tau_{yy}, \, \rho vw - \tau_{yz}, \, (E_t + p)v - u\tau_{xy} - v\tau_{yy} - w\tau_{yz} + q_y, \, \rho \phi - D\frac{\partial \phi}{\partial y} \end{bmatrix} \end{equation}</p> <p>\begin{equation} G = \begin{bmatrix} \rho w, \, \rho uw - \tau_{xz}, \, \rho vw - \tau_{yz}, \, \rho w^2 - \tau_{zz}, \, (E_t + p)w - u\tau_{xz} - v\tau_{yz} - w\tau_{zz} + q_z, \, \rho \phi - D\frac{\partial \phi}{\partial z} \end{bmatrix} \end{equation}</p> <p>A rectangular prism is used for the computational domain. Ambient pressure boundary conditions are used on the top and bottom walls and periodic boundary conditions are used in the spanwise direction. The size of the computational domain is \(50h \times 25h \times 1h\) where \(h\) is the height of the jet inlet. The inlet height is chosen to approximate the diameter of a human mouth (\(h = 0.04m\)). Numerical sponges are used at the top and bottom boundaries as well as the outlet boundary in order to dampen any reflectd flow characteristics. To approximate the conditions of a human cough, a max inlet velocity of \(10m/s\) is used with an approximately parabolic profile for stability considerations. Additionally, a coflow of about \(10\%\) of the jet inlet velocity is added to prevent spurious circulations towards the inlet. A conserved passive scalar contaminant is used to model the transport of aerosols. The scalar contaminant has a value of unity at the inlet and zero everywhere else.</p> <p>Shown below are iso-surface contours of \(\phi = {0.1, 0.33, 0.57}\) at \(t = 0.88\). We see that high concentration of the passive scalar persists well into the two meter domain, with significant mixing in the normal direction. The implications of this result are that the “six feet” rule is not effective to limit the spread of aerosols by flows from coughs or sneezes.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/comp_solver/phi_iso_39000.png" sizes="95vw"></source> <img src="/assets/img/comp_solver/phi_iso_39000.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="phi isocontour" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The strong scaling analysis of the code gave promising results. It is continuing to speed up without hitting diminishing results on up to 48 processors (the limit available during this project). The weak scaling analysis shows that the code does tradeoff some efficiency to run on larger numbers of processors.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/comp_solver/strong_scaling.png" sizes="95vw"></source> <img src="/assets/img/comp_solver/strong_scaling.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="strong scaling" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/comp_solver/weak_scaling.png" sizes="95vw"></source> <img src="/assets/img/comp_solver/weak_scaling.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="weak scaling" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Carlos A. Gonzalez. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: September 24, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>